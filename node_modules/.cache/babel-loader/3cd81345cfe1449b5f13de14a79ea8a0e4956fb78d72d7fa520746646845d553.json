{"ast":null,"code":"import React from\"react\";import DocumentUploadHeader from\"./DocumentUploadHeader\";import FileUploadField from\"./UploadFileFields\";import axios from\"axios\";import{useNavigate}from\"react-router-dom\";// Import the useNavigate hook\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const FormPendaftaranDocumentGenBI=()=>{const[files,setFiles]=React.useState({});const[uploading,setUploading]=React.useState(false);const[success,setSuccess]=React.useState(false);// State to track success\nconst[error,setError]=React.useState(\"\");// State to track error message\nconst navigate=useNavigate();// Initialize the navigate function\nconst handleFileChange=(e,name)=>{setFiles(prev=>({...prev,[name]:e.target.files[0]}));};const handleSubmit=async e=>{e.preventDefault();setUploading(true);setSuccess(false);// Reset success state on each submit\nsetError(\"\");// Reset any error\ntry{var _user$user;const user=JSON.parse(localStorage.getItem(\"user\"));// Get user from localStorage\nconst uploadedBy=user===null||user===void 0?void 0:(_user$user=user.user)===null||_user$user===void 0?void 0:_user$user.uuid;// Get user UUID\nif(!uploadedBy){alert(\"Gagal menemukan UUID user. Silakan login ulang.\");setUploading(false);return;}for(const[category,file]of Object.entries(files)){const formData=new FormData();formData.append(\"file\",file);formData.append(\"category\",category);formData.append(\"uploadedBy\",uploadedBy);// Add UUID\nawait axios.post(\"https://simbeasiswauk.site:9900/sms-mgmt/document/upload\",formData,{headers:{Authorization:`Bearer ${user.token}`}});console.log(`${category} uploaded`);}setSuccess(true);// Set success to true once all files are uploaded\nsetUploading(false);// Stop uploading\n}catch(err){console.error(\"Upload gagal\",err);setError(\"Terjadi kesalahan saat mengunggah dokumen.\");setUploading(false);// Stop uploading in case of error\n}};// If the form submission is successful, show a success notification\nif(success){return/*#__PURE__*/_jsxs(\"div\",{className:\"success-container\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Dokumen berhasil diunggah!\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Pendaftaran Anda berhasil. Silakan klik tombol di bawah untuk kembali ke homepage.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:()=>navigate(\"/\")// Redirect to homepage\n,children:\"Kembali ke Homepage\"})]});}return/*#__PURE__*/_jsx(\"main\",{className:\"bg-white\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid bg-white py-5 mt-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 col-xxl-10\",children:[/*#__PURE__*/_jsx(DocumentUploadHeader,{}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(FileUploadField,{label:\"Pass Foto *\",onChange:e=>handleFileChange(e,\"Pass Foto\")}),/*#__PURE__*/_jsx(FileUploadField,{label:\"Form Biodata A1 *\",onChange:e=>handleFileChange(e,\"Form Biodata A1\")}),/*#__PURE__*/_jsx(FileUploadField,{label:\"Form Keterampilan *\",onChange:e=>handleFileChange(e,\"Form Keterampilan\")}),/*#__PURE__*/_jsx(FileUploadField,{label:\"Surat Keterangan Tidak Mampu\",onChange:e=>handleFileChange(e,\"Surat Keterangan Tidak Mampu\")}),/*#__PURE__*/_jsx(FileUploadField,{label:\"Resume Pribadi *\",onChange:e=>handleFileChange(e,\"Resume Pribadi\")}),/*#__PURE__*/_jsx(FileUploadField,{label:\"Motivation Letter *\",onChange:e=>handleFileChange(e,\"Motivation Letter\")}),/*#__PURE__*/_jsx(FileUploadField,{label:\"Surat Pernyataan sedang tidak menerima beasiswa lain *\",onChange:e=>handleFileChange(e,\"Surat Pernyataan Tidak Menerima Beasiswa Lain\")}),/*#__PURE__*/_jsx(FileUploadField,{label:\"Surat Pernyataan Bermetrai *\",onChange:e=>handleFileChange(e,\"Surat Pernyataan Bermetrai\")}),/*#__PURE__*/_jsx(FileUploadField,{label:\"Fotocopy KTP *\",onChange:e=>handleFileChange(e,\"Fotocopy KTP\")}),/*#__PURE__*/_jsx(FileUploadField,{label:\"Fotocopy KTM *\",onChange:e=>handleFileChange(e,\"Fotocopy KTM\")}),/*#__PURE__*/_jsx(FileUploadField,{label:\"Transkrip Nilai *\",onChange:e=>handleFileChange(e,\"Transkrip Nilai\")}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-success mt-5 px-4 py-2 fw-semibold\",disabled:uploading,children:uploading?\"Mengunggah...\":\"Submit\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error})]})})})});};export default FormPendaftaranDocumentGenBI;","map":{"version":3,"names":["React","DocumentUploadHeader","FileUploadField","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","FormPendaftaranDocumentGenBI","files","setFiles","useState","uploading","setUploading","success","setSuccess","error","setError","navigate","handleFileChange","e","name","prev","target","handleSubmit","preventDefault","_user$user","user","JSON","parse","localStorage","getItem","uploadedBy","uuid","alert","category","file","Object","entries","formData","FormData","append","post","headers","Authorization","token","console","log","err","className","children","onClick","onSubmit","label","onChange","type","disabled"],"sources":["D:/Lovenia Skripsi 2/src/assets/Pages/Beasiswa/GenBI/FormPendaftaranDocumen.jsx/index.jsx"],"sourcesContent":["import React from \"react\";\r\nimport DocumentUploadHeader from \"./DocumentUploadHeader\";\r\nimport FileUploadField from \"./UploadFileFields\";\r\nimport axios from \"axios\";\r\nimport { useNavigate } from \"react-router-dom\"; // Import the useNavigate hook\r\n\r\nconst FormPendaftaranDocumentGenBI = () => {\r\n  const [files, setFiles] = React.useState({});\r\n  const [uploading, setUploading] = React.useState(false);\r\n  const [success, setSuccess] = React.useState(false); // State to track success\r\n  const [error, setError] = React.useState(\"\"); // State to track error message\r\n  const navigate = useNavigate(); // Initialize the navigate function\r\n\r\n  const handleFileChange = (e, name) => {\r\n    setFiles((prev) => ({\r\n      ...prev,\r\n      [name]: e.target.files[0],\r\n    }));\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setUploading(true);\r\n    setSuccess(false); // Reset success state on each submit\r\n    setError(\"\"); // Reset any error\r\n\r\n    try {\r\n      const user = JSON.parse(localStorage.getItem(\"user\")); // Get user from localStorage\r\n      const uploadedBy = user?.user?.uuid; // Get user UUID\r\n\r\n      if (!uploadedBy) {\r\n        alert(\"Gagal menemukan UUID user. Silakan login ulang.\");\r\n        setUploading(false);\r\n        return;\r\n      }\r\n\r\n      for (const [category, file] of Object.entries(files)) {\r\n        const formData = new FormData();\r\n        formData.append(\"file\", file);\r\n        formData.append(\"category\", category);\r\n        formData.append(\"uploadedBy\", uploadedBy); // Add UUID\r\n\r\n        await axios.post(\"https://simbeasiswauk.site:9900/sms-mgmt/document/upload\", formData, {\r\n          headers: {\r\n            Authorization: `Bearer ${user.token}`,\r\n          },\r\n        });\r\n\r\n        console.log(`${category} uploaded`);\r\n      }\r\n\r\n      setSuccess(true); // Set success to true once all files are uploaded\r\n      setUploading(false); // Stop uploading\r\n    } catch (err) {\r\n      console.error(\"Upload gagal\", err);\r\n      setError(\"Terjadi kesalahan saat mengunggah dokumen.\");\r\n      setUploading(false); // Stop uploading in case of error\r\n    }\r\n  };\r\n\r\n  // If the form submission is successful, show a success notification\r\n  if (success) {\r\n    return (\r\n      <div className=\"success-container\">\r\n        <h3>Dokumen berhasil diunggah!</h3>\r\n        <p>Pendaftaran Anda berhasil. Silakan klik tombol di bawah untuk kembali ke homepage.</p>\r\n        <button\r\n          className=\"btn btn-primary\"\r\n          onClick={() => navigate(\"/\")} // Redirect to homepage\r\n        >\r\n          Kembali ke Homepage\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <main className=\"bg-white\">\r\n      <div className=\"container-fluid bg-white py-5 mt-5\">\r\n        <div className=\"row justify-content-center\">\r\n          <div className=\"col-12 col-xxl-10\">\r\n            <DocumentUploadHeader />\r\n            <form onSubmit={handleSubmit}>\r\n              <FileUploadField label=\"Pass Foto *\" onChange={(e) => handleFileChange(e, \"Pass Foto\")} />\r\n              <FileUploadField label=\"Form Biodata A1 *\" onChange={(e) => handleFileChange(e, \"Form Biodata A1\")} />\r\n              <FileUploadField label=\"Form Keterampilan *\" onChange={(e) => handleFileChange(e, \"Form Keterampilan\")} />\r\n              <FileUploadField label=\"Surat Keterangan Tidak Mampu\" onChange={(e) => handleFileChange(e, \"Surat Keterangan Tidak Mampu\")} />\r\n              <FileUploadField label=\"Resume Pribadi *\" onChange={(e) => handleFileChange(e, \"Resume Pribadi\")} />\r\n              <FileUploadField label=\"Motivation Letter *\" onChange={(e) => handleFileChange(e, \"Motivation Letter\")} />\r\n              <FileUploadField label=\"Surat Pernyataan sedang tidak menerima beasiswa lain *\" onChange={(e) => handleFileChange(e, \"Surat Pernyataan Tidak Menerima Beasiswa Lain\")} />\r\n              <FileUploadField label=\"Surat Pernyataan Bermetrai *\" onChange={(e) => handleFileChange(e, \"Surat Pernyataan Bermetrai\")} />\r\n              <FileUploadField label=\"Fotocopy KTP *\" onChange={(e) => handleFileChange(e, \"Fotocopy KTP\")} />\r\n              <FileUploadField label=\"Fotocopy KTM *\" onChange={(e) => handleFileChange(e, \"Fotocopy KTM\")} />\r\n              <FileUploadField label=\"Transkrip Nilai *\" onChange={(e) => handleFileChange(e, \"Transkrip Nilai\")} />\r\n\r\n              <button type=\"submit\" className=\"btn btn-success mt-5 px-4 py-2 fw-semibold\" disabled={uploading}>\r\n                {uploading ? \"Mengunggah...\" : \"Submit\"}\r\n              </button>\r\n            </form>\r\n            {error && <div className=\"error-message\">{error}</div>}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </main>\r\n  );\r\n};\r\n\r\nexport default FormPendaftaranDocumentGenBI;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}